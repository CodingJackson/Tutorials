; Program: To illustrate EXECVE syscall by spawning a simple shell, using JMP-CALL-POP method

; Author: Paramjot Singh 
; Alias: theprojax

; EXECVE:  ->   ADDRESSS:NULL:ADDRESS:NULL
global _start

segment .text

_start:
	jmp address_finder

_shellcode:
	; Poping the address to RDI
	pop rdi
	; Pushing NULL onto the stack
	xor rax, rax
	push rax
	; Pushing ADDRESS onto the stack & setting RDX
	push rdi
	mov rdx, rsp
	; Pushing NULL onto the stack & setting RSI
	push rax
	mov rsi,rsp

	; Calling the EXECVE syscall
	add rax, 59
	syscall
	
address_finder:
	call _shellcode
	; Address to the next instructions pushes onto the stack 
	shellcode: dq 0x68732f2f6e69622f
